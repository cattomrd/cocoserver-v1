<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Gestión de Videos</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding-top: 20px;
            padding-bottom: 40px;
        }
        .video-thumbnail {
            height: 150px;
            object-fit: cover;
        }
        .nav-pills .nav-link.active {
            background-color: #007bff;
        }
        .playlist-card {
            transition: transform 0.3s;
        }
        .playlist-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .expiration-badge {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .progress {
            height: 25px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4 text-center">Plataforma de Gestión de Videos</h1>
        
        <!-- Navegación por pestañas -->
        <ul class="nav nav-pills mb-4" id="mainTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="videos-tab" data-bs-toggle="tab" href="#videos" role="tab">Videos</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="playlists-tab" data-bs-toggle="tab" href="#playlists" role="tab">Listas de Reproducción</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="raspberry-tab" data-bs-toggle="tab" href="#raspberry" role="tab">Raspberry Pi</a>
            </li>
        </ul>
        
        <!-- Contenido de las pestañas -->
        <div class="tab-content" id="mainTabContent">
            <!-- Pestaña de Videos -->
            <div class="tab-pane fade show active" id="videos" role="tabpanel">
                <div class="row mb-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Subir Nuevo Video</h5>
                                <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="collapse" data-bs-target="#uploadForm">
                                    <i class="bi bi-plus"></i> Mostrar/Ocultar
                                </button>
                            </div>
                            <div id="uploadForm" class="collapse">
                                <div class="card-body">
                                    <form id="videoUploadForm">
                                        <div class="mb-3">
                                            <label for="videoTitle" class="form-label">Título</label>
                                            <input type="text" class="form-control" id="videoTitle" name="title" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="videoDescription" class="form-label">Descripción</label>
                                            <textarea class="form-control" id="videoDescription" name="description" rows="3"></textarea>
                                        </div>
                                        <div class="mb-3">
                                            <label for="videoFile" class="form-label">Archivo de Video</label>
                                            <input type="file" class="form-control" id="videoFile" name="file" accept="video/*" required>
                                        </div>
                                        <div class="mb-3">
                                            <div class="progress d-none" id="uploadProgress">
                                                <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Subir Video</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Biblioteca de Videos</h5>
                            </div>
                            <div class="card-body">
                                <div class="row" id="videosList">
                                    <!-- Los videos se cargarán aquí dinámicamente -->
                                    <div class="col-12 text-center py-5" id="videosLoading">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p class="mt-2">Cargando videos...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pestaña de Listas de Reproducción -->
            <div class="tab-pane fade" id="playlists" role="tabpanel">
                <div class="row mb-4">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Crear Nueva Lista de Reproducción</h5>
                                <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="collapse" data-bs-target="#playlistForm">
                                    <i class="bi bi-plus"></i> Mostrar/Ocultar
                                </button>
                            </div>
                            <div id="playlistForm" class="collapse">
                                <div class="card-body">
                                    <form id="playlistCreateForm">
                                        <div class="mb-3">
                                            <label for="playlistTitle" class="form-label">Título</label>
                                            <input type="text" class="form-control" id="playlistTitle" name="title" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="playlistDescription" class="form-label">Descripción</label>
                                            <textarea class="form-control" id="playlistDescription" name="description" rows="3"></textarea>
                                        </div>
                                        <div class="mb-3">
                                            <label for="playlistExpiration" class="form-label">Fecha de Expiración (opcional)</label>
                                            <input type="datetime-local" class="form-control" id="playlistExpiration" name="expiration_date">
                                        </div>
                                        <button type="submit" class="btn btn-primary">Crear Lista de Reproducción</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Listas de Reproducción</h5>
                            </div>
                            <div class="card-body">
                                <div class="row" id="playlistsList">
                                    <!-- Las listas se cargarán aquí dinámicamente -->
                                    <div class="col-12 text-center py-5" id="playlistsLoading">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Cargando...</span>
                                        </div>
                                        <p class="mt-2">Cargando listas de reproducción...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Pestaña de Raspberry Pi -->
            <div class="tab-pane fade" id="raspberry" role="tabpanel">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Información para Clientes Raspberry Pi</h5>
                            </div>
                            <div class="card-body">
                                <h6>Instrucciones de configuración</h6>
                                <p>Para configurar su Raspberry Pi con esta plataforma, siga estos pasos:</p>
                                <ol>
                                    <li>Asegúrese de que su Raspberry Pi esté conectada a internet.</li>
                                    <li>Descargue el script cliente desde el siguiente enlace:
                                        <a href="#" class="btn btn-sm btn-outline-primary ms-2">Descargar Cliente</a>
                                    </li>
                                    <li>Ejecute el script con los siguientes parámetros:</li>
                                </ol>
                                <div class="bg-light p-3 mb-4">
                                    <code>python3 client.py --server="http://[URL_DEL_SERVIDOR]" --download-path="./videos" --check-interval=30</code>
                                </div>
                                
                                <div class="alert alert-info">
                                    <h6>API para Raspberry Pi</h6>
                                    <p>Los dispositivos Raspberry Pi pueden acceder a las listas de reproducción activas mediante el siguiente endpoint:</p>
                                    <div class="bg-white p-2">
                                        <code>GET /raspberry/playlists/active</code>
                                    </div>
                                </div>
                                
                                <h6 class="mt-4">Estado de Listas Activas para Raspberry Pi</h6>
                                <div id="raspberryActiveList">
                                    <!-- Listas activas para Raspberry Pi -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para detalles de la lista de reproducción -->
    <div class="modal fade" id="playlistDetailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="playlistDetailTitle">Detalles de la Lista</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="playlistInfo">
                        <p id="playlistDetailDescription"></p>
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <div>
                                <span class="badge bg-info" id="playlistDetailDate"></span>
                                <span class="badge" id="playlistDetailStatus"></span>
                            </div>
                            <div>
                                <button class="btn btn-sm btn-success" id="playlistDownloadBtn">
                                    <i class="bi bi-download"></i> Descargar Lista
                                </button>
                            </div>
                        </div>
                        
                        <h6 class="mb-3">Videos en esta lista</h6>
                        <div class="list-group" id="playlistVideos">
                            <!-- Videos en la lista -->
                        </div>
                        
                        <hr class="my-4" />
                        
                        <h6>Agregar videos a esta lista</h6>
                        <div class="mb-3">
                            <select class="form-select" id="addVideoSelect">
                                <option value="">Seleccionar video...</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="addVideoBtn">Agregar Video</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button type="button" class="btn btn-danger" id="deletePlaylistBtn">Eliminar Lista</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL = '/api'; // Cambiar según la configuración del servidor
        let allVideos = [];
        let allPlaylists = [];
        let currentPlaylistId = null;
        
        // Función para cargar videos
        async function loadVideos() {
            try {
                const response = await fetch(`${API_URL}/videos/`);
                allVideos = await response.json();
                
                const videosList = document.getElementById('videosList');
                videosList.innerHTML = '';
                
                if (allVideos.length === 0) {
                    videosList.innerHTML = `
                        <div class="col-12 text-center py-5">
                            <p>No hay videos disponibles. ¡Sube tu primer video!</p>
                        </div>
                    `;
                    return;
                }
                
                allVideos.forEach(video => {
                    const videoCard = document.createElement('div');
                    videoCard.className = 'col-md-4 mb-4';
                    videoCard.innerHTML = `
                        <div class="card">
                            <div class="card-img-top bg-dark d-flex align-items-center justify-content-center" style="height: 180px;">
                                <i class="bi bi-film" style="font-size: 3rem; color: #aaa;"></i>
                            </div>
                            <div class="card-body">
                                <h5 class="card-title">${video.title}</h5>
                                <p class="card-text small text-truncate">${video.description || 'Sin descripción'}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted">${new Date(video.upload_date).toLocaleDateString()}</small>
                                    <div class="btn-group">
                                        <a href="${API_URL}/videos/${video.id}/download" class="btn btn-sm btn-outline-secondary">
                                            <i class="bi bi-download"></i> Descargar
                                        </a>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteVideo(${video.id})">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    videosList.appendChild(videoCard);
                });
            } catch (error) {
                console.error('Error al cargar videos:', error);
                document.getElementById('videosList').innerHTML = `
                    <div class="col-12 text-center py-5">
                        <div class="alert alert-danger">Error al cargar videos</div>
                    </div>
                `;
            } finally {
                document.getElementById('videosLoading').style.display = 'none';
            }
        }
        
        // Función para cargar playlists
        async function loadPlaylists() {
            try {
                const response = await fetch(`${API_URL}/playlists/`);
                allPlaylists = await response.json();
                
                const playlistsList = document.getElementById('playlistsList');
                playlistsList.innerHTML = '';
                
                if (allPlaylists.length === 0) {
                    playlistsList.innerHTML = `
                        <div class="col-12 text-center py-5">
                            <p>No hay listas de reproducción disponibles. ¡Crea tu primera lista!</p>
                        </div>
                    `;
                    return;
                }
                
                allPlaylists.forEach(playlist => {
                    const isActive = isPlaylistActive(playlist);
                    const expirationText = playlist.expiration_date 
                        ? `Expira: ${new Date(playlist.expiration_date).toLocaleDateString()}`
                        : 'Sin fecha de expiración';
                        
                    const playlistCard = document.createElement('div');
                    playlistCard.className = 'col-md-4 mb-4';
                    playlistCard.innerHTML = `
                        <div class="card playlist-card">
                            <div class="card-body">
                                <h5 class="card-title">${playlist.title}</h5>
                                <p class="card-text text-truncate">${playlist.description || 'Sin descripción'}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge ${isActive ? 'bg-success' : 'bg-danger'}">
                                        ${isActive ? 'Activa' : 'Inactiva'}
                                    </span>
                                    <small>${expirationText}</small>
                                </div>
                                <div class="mt-3">
                                    <span class="badge bg-secondary">${playlist.videos.length} videos</span>
                                </div>
                            </div>
                            <div class="card-footer bg-transparent">
                                <button class="btn btn-primary btn-sm w-100" onclick="openPlaylistDetail(${playlist.id})">
                                    Ver Detalles
                                </button>
                            </div>
                        </div>
                    `;
                    playlistsList.appendChild(playlistCard);
                });
            } catch (error) {
                console.error('Error al cargar playlists:', error);
                document.getElementById('playlistsList').innerHTML = `
                    <div class="col-12 text-center py-5">
                        <div class="alert alert-danger">Error al cargar listas de reproducción</div>
                    </div>
                `;
            } finally {
                document.getElementById('playlistsLoading').style.display = 'none';
            }
        }
        
        // Verificar si una playlist está activa
        function isPlaylistActive(playlist) {
            if (!playlist.is_active) return false;
            if (playlist.expiration_date && new Date(playlist.expiration_date) < new Date()) return false;
            return true;
        }
        
        // Abrir detalles de playlist
        async function openPlaylistDetail(playlistId) {
            currentPlaylistId = playlistId;
            try {
                const response = await fetch(`${API_URL}/playlists/${playlistId}`);
                const playlist = await response.json();
                
                document.getElementById('playlistDetailTitle').textContent = playlist.title;
                document.getElementById('playlistDetailDescription').textContent = playlist.description || 'Sin descripción';
                document.getElementById('playlistDetailDate').textContent = `Creada: ${new Date(playlist.creation_date).toLocaleDateString()}`;
                
                const statusBadge = document.getElementById('playlistDetailStatus');
                const isActive = isPlaylistActive(playlist);
                statusBadge.className = `badge ${isActive ? 'bg-success' : 'bg-danger'}`;
                statusBadge.textContent = isActive ? 'Activa' : 'Inactiva';
                
                document.getElementById('playlistDownloadBtn').onclick = () => {
                    window.location.href = `${API_URL}/playlists/${playlistId}/download`;
                };
                
                // Mostrar videos en la playlist
                const playlistVideos = document.getElementById('playlistVideos');
                playlistVideos.innerHTML = '';
                
                if (playlist.videos.length === 0) {
                    playlistVideos.innerHTML = '<p class="text-center">No hay videos en esta lista</p>';
                } else {
                    playlist.videos.forEach(video => {
                        const videoItem = document.createElement('div');
                        videoItem.className = 'list-group-item list-group-item-action d-flex justify-content-between align-items-center';
                        videoItem.innerHTML = `
                            <div>
                                <h6 class="mb-1">${video.title}</h6>
                                <small>${video.description || 'Sin descripción'}</small>
                            </div>
                            <button class="btn btn-sm btn-outline-danger" onclick="removeVideoFromPlaylist(${playlistId}, ${video.id})">
                                <i class="bi bi-x"></i>
                            </button>
                        `;
                        playlistVideos.appendChild(videoItem);
                    });
                }
                
                // Cargar videos disponibles para agregar
                const addVideoSelect = document.getElementById('addVideoSelect');
                addVideoSelect.innerHTML = '<option value="">Seleccionar video...</option>';
                
                // Filtrar videos que no están en la playlist
                const playlistVideoIds = new Set(playlist.videos.map(v => v.id));
                allVideos.forEach(video => {
                    if (!playlistVideoIds.has(video.id)) {
                        const option = document.createElement('option');
                        option.value = video.id;
                        option.textContent = video.title;
                        addVideoSelect.appendChild(option);
                    }
                });
                
                // Configurar botón para agregar video
                document.getElementById('addVideoBtn').onclick = () => {
                    const videoId = addVideoSelect.value;
                    if (videoId) {
                        addVideoToPlaylist(playlistId, parseInt(videoId));
                    }
                };
                
                // Configurar botón para eliminar playlist
                document.getElementById('deletePlaylistBtn').onclick = () => {
                    if (confirm('¿Estás seguro de que deseas eliminar esta lista de reproducción?')) {
                        deletePlaylist(playlistId);
                    }
                };
                
                // Mostrar el modal
                const modal = new bootstrap.Modal(document.getElementById('playlistDetailModal'));
                modal.show();
                
            } catch (error) {
                console.error('Error al cargar detalles de la playlist:', error);
                alert('Error al cargar los detalles de la lista de reproducción');
            }
        }
        
        // Subir un video
        async function uploadVideo(formData) {
            const progressBar = document.querySelector('#uploadProgress .progress-bar');
            document.getElementById('uploadProgress').classList.remove('d-none');
            
            try {
                const xhr = new XMLHttpRequest();
                xhr.open('POST', `${API_URL}/videos/`, true);
                
                xhr.upload.onprogress = (e) => {
                    if (e.lengthComputable) {
                        const percentComplete = Math.round((e.loaded / e.total) * 100);
                        progressBar.style.width = percentComplete + '%';
                        progressBar.textContent = percentComplete + '%';
                        progressBar.setAttribute('aria-valuenow', percentComplete);
                    }
                };
                
                xhr.onload = function() {
                    if (xhr.status === 200 || xhr.status === 201) {
                        alert('Video subido correctamente');
                        document.getElementById('videoUploadForm').reset();
                        loadVideos();
                    } else {
                        alert('Error al subir el video: ' + xhr.statusText);
                    }
                    document.getElementById('uploadProgress').classList.add('d-none');
                };
                
                xhr.onerror = function() {
                    alert('Error de red al intentar subir el video');
                    document.getElementById('uploadProgress').classList.add('d-none');
                };
                
                xhr.send(formData);
                
            } catch (error) {
                console.error('Error al subir video:', error);
                alert('Error al subir el video');
                document.getElementById('uploadProgress').classList.add('d-none');
            }
        }
        
        // Crear una playlist
        async function createPlaylist(playlistData) {
            try {
                const response = await fetch(`${API_URL}/playlists/`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(playlistData),
                });
                
                if (response.ok) {
                    alert('Lista de reproducción creada correctamente');
                    document.getElementById('playlistCreateForm').reset();
                    loadPlaylists();
                } else {
                    const error = await response.json();
                    alert(`Error al crear la lista: ${error.detail || response.statusText}`);
                }
            } catch (error) {
                console.error('Error al crear playlist:', error);
                alert('Error al crear la lista de reproducción');
            }
        }
        
        // Eliminar un video
        async function deleteVideo(videoId) {
            if (!confirm('¿Estás seguro de que deseas eliminar este video?')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/videos/${videoId}`, {
                    method: 'DELETE',
                });
                
                if (response.ok) {
                    alert('Video eliminado correctamente');
                    loadVideos();
                } else {
                    const error = await response.json();
                    alert(`Error al eliminar el video: ${error.detail || response.statusText}`);
                }
            } catch (error) {
                console.error('Error al eliminar video:', error);
                alert('Error al eliminar el video');
            }
        }
        
        // Eliminar una playlist
        async function deletePlaylist(playlistId) {
            try {
                const response = await fetch(`${API_URL}/playlists/${playlistId}`, {
                    method: 'DELETE',
                });
                
                if (response.ok) {
                    alert('Lista de reproducción eliminada correctamente');
                    loadPlaylists();
                    bootstrap.Modal.getInstance(document.getElementById('playlistDetailModal')).hide();
                } else {
                    const error = await response.json();
                    alert(`Error al eliminar la lista: ${error.detail || response.statusText}`);
                }
            } catch (error) {
                console.error('Error al eliminar playlist:', error);
                alert('Error al eliminar la lista de reproducción');
            }
        }
        
        // Agregar video a playlist
        async function addVideoToPlaylist(playlistId, videoId) {
            try {
                const response = await fetch(`${API_URL}/playlists/${playlistId}/videos/${videoId}`, {
                    method: 'POST',
                });
                
                if (response.ok) {
                    alert('Video añadido a la lista correctamente');
                    openPlaylistDetail(playlistId); // Recargar detalles
                } else {
                    const error = await response.json();
                    alert(`Error al añadir el video: ${error.detail || response.statusText}`);
                }
            } catch (error) {
                console.error('Error al añadir video a playlist:', error);
                alert('Error al añadir el video a la lista');
            }
        }
        
        // Eliminar video de playlist
        async function removeVideoFromPlaylist(playlistId, videoId) {
            try {
                const response = await fetch(`${API_URL}/playlists/${playlistId}/videos/${videoId}`, {
                    method: 'DELETE',
                });
                
                if (response.ok) {
                    alert('Video eliminado de la lista correctamente');
                    openPlaylistDetail(playlistId); // Recargar detalles
                } else {
                    const error = await response.json();
                    alert(`Error al eliminar el video: ${error.detail || response.statusText}`);
                }
            } catch (error) {
                console.error('Error al eliminar video de playlist:', error);
                alert('Error al eliminar el video de la lista');
            }
        }
        
        // Cargar playlists activas para Raspberry Pi
        async function loadRaspberryActivePlaylists() {
            try {
                const response = await fetch(`${API_URL}/raspberry/playlists/active`);
                const activePlaylists = await response.json();
                
                const raspberryActiveList = document.getElementById('raspberryActiveList');
                raspberryActiveList.innerHTML = '';
                
                if (activePlaylists.length === 0) {
                    raspberryActiveList.innerHTML = `
                        <div class="alert alert-warning">
                            No hay listas de reproducción activas para dispositivos Raspberry Pi
                        </div>
                    `;
                    return;
                }
                
                const table = document.createElement('table');
                table.className = 'table table-striped';
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th>Título</th>
                            <th>Expiración</th>
                            <th>Videos</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                `;
                
                const tbody = table.querySelector('tbody');
                
                activePlaylists.forEach(playlist => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${playlist.title}</td>
                        <td>${playlist.expiration_date ? new Date(playlist.expiration_date).toLocaleDateString() : 'Sin expiración'}</td>
                        <td>${playlist.videos.length} videos</td>
                    `;
                    tbody.appendChild(row);
                });
                
                raspberryActiveList.appendChild(table);
                
            } catch (error) {
                console.error('Error al cargar playlists activas para Raspberry Pi:', error);
                document.getElementById('raspberryActiveList').innerHTML = `
                    <div class="alert alert-danger">
                        Error al cargar listas de reproducción activas
                    </div>
                `;
            }
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar videos y playlists inicialmente
            loadVideos();
            loadPlaylists();
            
            // Manejar navegación por pestañas
            document.querySelectorAll('a[data-bs-toggle="tab"]').forEach(tab => {
                tab.addEventListener('shown.bs.tab', function(e) {
                    const target = e.target.getAttribute('href');
                    if (target === '#raspberry') {
                        loadRaspberryActivePlaylists();
                    }
                });
            });
            
            // Formulario de subida de video
            document.getElementById('videoUploadForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const formData = new FormData(this);
                uploadVideo(formData);
            });
            
            // Formulario de creación de playlist
            document.getElementById('playlistCreateForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const playlistData = {
                    title: document.getElementById('playlistTitle').value,
                    description: document.getElementById('playlistDescription').value,
                    expiration_date: document.getElementById('playlistExpiration').value || null
                };
                
                createPlaylist(playlistData);
            });
        });
        
        // Inicializar tooltips de Bootstrap
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    </script>
</body>
</html>